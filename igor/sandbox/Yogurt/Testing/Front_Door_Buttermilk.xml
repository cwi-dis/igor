<?xml version="1.0" encoding="UTF-8"?>
<actor_collection>
	<actor>
		<name>PIR</name>
		<states>
			<state>
				<localName>present</localName>
				<path>/active</path>
			</state>
			<state>
				<localName>brightness</localName>
				<path>/luminosity</path>
			</state>
		</states>
		<instances>
			<instance>
				<name>entrancePIR</name>
				<path>//data/sensors/PIR[uuid='d06a66e10b6d4a1285143080c88b029c']</path>
			</instance>
		</instances>
	</actor>
	<actor>
		<name>card_reader</name>
		<states>
			<state>
				<localName>locked</localName>
				<path>locked</path>
			</state>
		</states>
		<instances>
			<instance>
				<name>frontKey</name>
				<path>//data/sensors/PIR[uuid='d06a66e10b6d4a1285143080c88b029c']</path>
			</instance>
		</instances>
	</actor>
	<actor>
		<name>front_door</name>
		<states>
			<state>
				<localName>locked</localName>
				<path>locked</path>
			</state>
		</states>
		<actions>
			<action>
				<on>
					<input>PIR</input>
					<state>present</state>
				</on>
				<guards>
					<when>
						<condition>
							<check>PIR.present</check>
							<operator>=</operator>
							<against>True</against>
						</condition>
						<update>
							<target>locked</target>
							<value>False</value>
						</update>
					</when>
					<when>
						<condition>
							<check>PIR.present</check>
							<operator>=</operator>
							<against>False</against>
						</condition>
						<timer>
							<duration>10.0</duration> 
							<execute>
								<update>
									<target>locked</target>
									<value>True</value>
								</update>
							</execute>
						</timer>
					</when>
				</guards>
			</action>
			<action>
				<on>
					<input>card_reader</input>
					<state>locked</state>
				</on>
				<guards>
					<when>
						<condition>
							<check>card_reader.locked</check>
							<operator>=</operator>
							<against>False</against>
						</condition>
						<update>
							<target>locked</target>
							<value>False</value>
						</update>
					</when>
				</guards>
			</action>
		</actions>
		<instances>
			<instance>
				<name>mainDoor</name>
				<path>//data/devices/door[IP='192.168.37.53']</path>
				<inputs>
					<input>
						<type>PIR</type>
						<id>entrancePIR</id>
					</input>
					<input>
						<type>card_reader</type>
						<id>frontKey</id>
					</input>
				</inputs>	
			</instance>
		</instances>
	</actor>
</actor_collection>